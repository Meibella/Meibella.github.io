<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=emulateIE7" />
    <title>Coverage for D:\Github\synthpops\synthpops\plot_tools.py: 78%</title>
    <link rel="stylesheet" href="style.css" type="text/css">
    <script type="text/javascript" src="jquery.min.js"></script>
    <script type="text/javascript" src="jquery.hotkeys.js"></script>
    <script type="text/javascript" src="jquery.isonscreen.js"></script>
    <script type="text/javascript" src="coverage_html.js"></script>
    <script type="text/javascript">
        jQuery(document).ready(coverage.pyfile_ready);
    </script>
</head>
<body class="pyfile">
<div id="header">
    <div class="content">
        <h1>Coverage for <b>D:\Github\synthpops\synthpops\plot_tools.py</b> :
            <span class="pc_cov">78%</span>
        </h1>
        <img id="keyboard_icon" src="keybd_closed.png" alt="Show keyboard shortcuts" />
        <h2 class="stats">
            105 statements &nbsp;
            <button type="button" class="run shortkey_r button_toggle_run" title="Toggle lines run">82 run</button>
            <button type="button" class="mis show_mis shortkey_m button_toggle_mis" title="Toggle lines missing">23 missing</button>
            <button type="button" class="exc show_exc shortkey_x button_toggle_exc" title="Toggle lines excluded">0 excluded</button>
        </h2>
    </div>
</div>
<div class="help_panel">
    <img id="panel_icon" src="keybd_open.png" alt="Hide keyboard shortcuts" />
    <p class="legend">Hot-keys on this page</p>
    <div>
    <p class="keyhelp">
        <span class="key">r</span>
        <span class="key">m</span>
        <span class="key">x</span>
        <span class="key">p</span> &nbsp; toggle line displays
    </p>
    <p class="keyhelp">
        <span class="key">j</span>
        <span class="key">k</span> &nbsp; next/prev highlighted chunk
    </p>
    <p class="keyhelp">
        <span class="key">0</span> &nbsp; (zero) top of page
    </p>
    <p class="keyhelp">
        <span class="key">1</span> &nbsp; (one) first highlighted chunk
    </p>
    </div>
</div>
<div id="source">
    <p id="t1" class="pln"><span class="n"><a href="#t1">1</a></span><span class="t"><span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p id="t2" class="pln"><span class="n"><a href="#t2">2</a></span><span class="t"><span class="str">This module plots the age-specific contact matrix in different settings.</span>&nbsp;</span><span class="r"></span></p>
    <p id="t3" class="pln"><span class="n"><a href="#t3">3</a></span><span class="t"><span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p id="t4" class="pln"><span class="n"><a href="#t4">4</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t5" class="run"><span class="n"><a href="#t5">5</a></span><span class="t"><span class="key">import</span> <span class="nam">os</span>&nbsp;</span><span class="r"></span></p>
    <p id="t6" class="run"><span class="n"><a href="#t6">6</a></span><span class="t"><span class="key">from</span> <span class="nam">copy</span> <span class="key">import</span> <span class="nam">deepcopy</span>&nbsp;</span><span class="r"></span></p>
    <p id="t7" class="pln"><span class="n"><a href="#t7">7</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t8" class="run"><span class="n"><a href="#t8">8</a></span><span class="t"><span class="key">import</span> <span class="nam">sciris</span> <span class="key">as</span> <span class="nam">sc</span>&nbsp;</span><span class="r"></span></p>
    <p id="t9" class="run"><span class="n"><a href="#t9">9</a></span><span class="t"><span class="key">import</span> <span class="nam">numpy</span> <span class="key">as</span> <span class="nam">np</span>&nbsp;</span><span class="r"></span></p>
    <p id="t10" class="run"><span class="n"><a href="#t10">10</a></span><span class="t"><span class="key">import</span> <span class="nam">networkx</span> <span class="key">as</span> <span class="nam">nx</span>&nbsp;</span><span class="r"></span></p>
    <p id="t11" class="pln"><span class="n"><a href="#t11">11</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t12" class="run"><span class="n"><a href="#t12">12</a></span><span class="t"><span class="key">import</span> <span class="nam">matplotlib</span> <span class="key">as</span> <span class="nam">mplt</span>&nbsp;</span><span class="r"></span></p>
    <p id="t13" class="run"><span class="n"><a href="#t13">13</a></span><span class="t"><span class="key">import</span> <span class="nam">matplotlib</span><span class="op">.</span><span class="nam">pyplot</span> <span class="key">as</span> <span class="nam">plt</span>&nbsp;</span><span class="r"></span></p>
    <p id="t14" class="run"><span class="n"><a href="#t14">14</a></span><span class="t"><span class="key">from</span> <span class="nam">matplotlib</span><span class="op">.</span><span class="nam">colors</span> <span class="key">import</span> <span class="nam">LogNorm</span>&nbsp;</span><span class="r"></span></p>
    <p id="t15" class="run"><span class="n"><a href="#t15">15</a></span><span class="t"><span class="key">from</span> <span class="nam">mpl_toolkits</span><span class="op">.</span><span class="nam">axes_grid1</span> <span class="key">import</span> <span class="nam">make_axes_locatable</span>&nbsp;</span><span class="r"></span></p>
    <p id="t16" class="run"><span class="n"><a href="#t16">16</a></span><span class="t"><span class="key">import</span> <span class="nam">cmocean</span>&nbsp;</span><span class="r"></span></p>
    <p id="t17" class="run"><span class="n"><a href="#t17">17</a></span><span class="t"><span class="key">import</span> <span class="nam">cmasher</span> <span class="key">as</span> <span class="nam">cmr</span>&nbsp;</span><span class="r"></span></p>
    <p id="t18" class="pln"><span class="n"><a href="#t18">18</a></span><span class="t"><span class="com"># from matplotlib.ticker import LogLocator, LogFormatter</span>&nbsp;</span><span class="r"></span></p>
    <p id="t19" class="pln"><span class="n"><a href="#t19">19</a></span><span class="t"><span class="com"># import matplotlib.font_manager as font_manager</span>&nbsp;</span><span class="r"></span></p>
    <p id="t20" class="pln"><span class="n"><a href="#t20">20</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t21" class="run"><span class="n"><a href="#t21">21</a></span><span class="t"><span class="key">from</span> <span class="op">.</span> <span class="key">import</span> <span class="nam">base</span> <span class="key">as</span> <span class="nam">spb</span>&nbsp;</span><span class="r"></span></p>
    <p id="t22" class="run"><span class="n"><a href="#t22">22</a></span><span class="t"><span class="key">from</span> <span class="op">.</span> <span class="key">import</span> <span class="nam">data_distributions</span> <span class="key">as</span> <span class="nam">spdata</span>&nbsp;</span><span class="r"></span></p>
    <p id="t23" class="run"><span class="n"><a href="#t23">23</a></span><span class="t"><span class="key">from</span> <span class="op">.</span> <span class="key">import</span> <span class="nam">sampling</span> <span class="key">as</span> <span class="nam">spsamp</span>&nbsp;</span><span class="r"></span></p>
    <p id="t24" class="run"><span class="n"><a href="#t24">24</a></span><span class="t"><span class="key">from</span> <span class="op">.</span> <span class="key">import</span> <span class="nam">contacts</span> <span class="key">as</span> <span class="nam">spct</span>&nbsp;</span><span class="r"></span></p>
    <p id="t25" class="run"><span class="n"><a href="#t25">25</a></span><span class="t"><span class="key">from</span> <span class="op">.</span> <span class="key">import</span> <span class="nam">contact_networks</span> <span class="key">as</span> <span class="nam">spcn</span>&nbsp;</span><span class="r"></span></p>
    <p id="t26" class="run"><span class="n"><a href="#t26">26</a></span><span class="t"><span class="key">from</span> <span class="op">.</span><span class="nam">config</span> <span class="key">import</span> <span class="nam">datadir</span>&nbsp;</span><span class="r"></span></p>
    <p id="t27" class="pln"><span class="n"><a href="#t27">27</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t28" class="pln"><span class="n"><a href="#t28">28</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t29" class="pln"><span class="n"><a href="#t29">29</a></span><span class="t"><span class="com"># Pretty fonts</span>&nbsp;</span><span class="r"></span></p>
    <p id="t30" class="run"><span class="n"><a href="#t30">30</a></span><span class="t"><span class="key">try</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t31" class="run"><span class="n"><a href="#t31">31</a></span><span class="t">    <span class="nam">fontstyle</span> <span class="op">=</span> <span class="str">'Roboto_Condensed'</span>&nbsp;</span><span class="r"></span></p>
    <p id="t32" class="run"><span class="n"><a href="#t32">32</a></span><span class="t">    <span class="nam">mplt</span><span class="op">.</span><span class="nam">rcParams</span><span class="op">[</span><span class="str">'font.family'</span><span class="op">]</span> <span class="op">=</span> <span class="nam">fontstyle</span><span class="op">.</span><span class="nam">replace</span><span class="op">(</span><span class="str">'_'</span><span class="op">,</span> <span class="str">' '</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t33" class="mis show_mis"><span class="n"><a href="#t33">33</a></span><span class="t"><span class="key">except</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t34" class="mis show_mis"><span class="n"><a href="#t34">34</a></span><span class="t">    <span class="nam">mplt</span><span class="op">.</span><span class="nam">rcParams</span><span class="op">[</span><span class="str">'font.family'</span><span class="op">]</span> <span class="op">=</span> <span class="str">'Roboto'</span>&nbsp;</span><span class="r"></span></p>
    <p id="t35" class="run"><span class="n"><a href="#t35">35</a></span><span class="t"><span class="nam">mplt</span><span class="op">.</span><span class="nam">rcParams</span><span class="op">[</span><span class="str">'font.size'</span><span class="op">]</span> <span class="op">=</span> <span class="num">16</span>&nbsp;</span><span class="r"></span></p>
    <p id="t36" class="pln"><span class="n"><a href="#t36">36</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t37" class="pln"><span class="n"><a href="#t37">37</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t38" class="run"><span class="n"><a href="#t38">38</a></span><span class="t"><span class="key">def</span> <span class="nam">calculate_contact_matrix</span><span class="op">(</span><span class="nam">population</span><span class="op">,</span> <span class="nam">density_or_frequency</span><span class="op">=</span><span class="str">'density'</span><span class="op">,</span> <span class="nam">setting_code</span><span class="op">=</span><span class="str">'H'</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t39" class="pln"><span class="n"><a href="#t39">39</a></span><span class="t">    <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p id="t40" class="pln"><span class="n"><a href="#t40">40</a></span><span class="t"><span class="str">    Calculate the symmetric age-specific contact matrix from the connections</span>&nbsp;</span><span class="r"></span></p>
    <p id="t41" class="pln"><span class="n"><a href="#t41">41</a></span><span class="t"><span class="str">    for all people in the population. density_or_frequency sets the type of</span>&nbsp;</span><span class="r"></span></p>
    <p id="t42" class="pln"><span class="n"><a href="#t42">42</a></span><span class="t"><span class="str">    contact matrix calculated.</span>&nbsp;</span><span class="r"></span></p>
    <p id="t43" class="pln"><span class="n"><a href="#t43">43</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t44" class="pln"><span class="n"><a href="#t44">44</a></span><span class="t"><span class="str">    When density_or_frequency is set to 'frequency' each person is assumed to</span>&nbsp;</span><span class="r"></span></p>
    <p id="t45" class="pln"><span class="n"><a href="#t45">45</a></span><span class="t"><span class="str">    have a fixed amount of contact with others they are connected to in a</span>&nbsp;</span><span class="r"></span></p>
    <p id="t46" class="pln"><span class="n"><a href="#t46">46</a></span><span class="t"><span class="str">    setting so each person will split their contact amount equally among their</span>&nbsp;</span><span class="r"></span></p>
    <p id="t47" class="pln"><span class="n"><a href="#t47">47</a></span><span class="t"><span class="str">    connections. This means that if a person has links to 4 other individuals</span>&nbsp;</span><span class="r"></span></p>
    <p id="t48" class="pln"><span class="n"><a href="#t48">48</a></span><span class="t"><span class="str">    then 1/4 will be added to the matrix element matrix[age_i][age_j] for each</span>&nbsp;</span><span class="r"></span></p>
    <p id="t49" class="pln"><span class="n"><a href="#t49">49</a></span><span class="t"><span class="str">    link, where age_i is the age of the individual and age_j is the age of the</span>&nbsp;</span><span class="r"></span></p>
    <p id="t50" class="pln"><span class="n"><a href="#t50">50</a></span><span class="t"><span class="str">    contact. This follows the mass action principle such that increased density</span>&nbsp;</span><span class="r"></span></p>
    <p id="t51" class="pln"><span class="n"><a href="#t51">51</a></span><span class="t"><span class="str">    or number of people a person is in contact with leads to decreased per-link</span>&nbsp;</span><span class="r"></span></p>
    <p id="t52" class="pln"><span class="n"><a href="#t52">52</a></span><span class="t"><span class="str">    or connection contact rate.</span>&nbsp;</span><span class="r"></span></p>
    <p id="t53" class="pln"><span class="n"><a href="#t53">53</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t54" class="pln"><span class="n"><a href="#t54">54</a></span><span class="t"><span class="str">    When density_or_frequency is set to 'density' the amount of contact each</span>&nbsp;</span><span class="r"></span></p>
    <p id="t55" class="pln"><span class="n"><a href="#t55">55</a></span><span class="t"><span class="str">    person has with others scales with the number of people they are connected</span>&nbsp;</span><span class="r"></span></p>
    <p id="t56" class="pln"><span class="n"><a href="#t56">56</a></span><span class="t"><span class="str">    to. This means that a person with connections to 4 individuals has a higher</span>&nbsp;</span><span class="r"></span></p>
    <p id="t57" class="pln"><span class="n"><a href="#t57">57</a></span><span class="t"><span class="str">    total contact rate than a person with connection to 3 individuals. For this</span>&nbsp;</span><span class="r"></span></p>
    <p id="t58" class="pln"><span class="n"><a href="#t58">58</a></span><span class="t"><span class="str">    definition if a person has links to 4 other individuals then 1 will be</span>&nbsp;</span><span class="r"></span></p>
    <p id="t59" class="pln"><span class="n"><a href="#t59">59</a></span><span class="t"><span class="str">    added to the matrix element matrix[age_i][age_j] for each contact. This</span>&nbsp;</span><span class="r"></span></p>
    <p id="t60" class="pln"><span class="n"><a href="#t60">60</a></span><span class="t"><span class="str">    follows the 'pseudo'mass action principle such that the per-link or</span>&nbsp;</span><span class="r"></span></p>
    <p id="t61" class="pln"><span class="n"><a href="#t61">61</a></span><span class="t"><span class="str">    connection contact rate is constant.</span>&nbsp;</span><span class="r"></span></p>
    <p id="t62" class="pln"><span class="n"><a href="#t62">62</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t63" class="pln"><span class="n"><a href="#t63">63</a></span><span class="t"><span class="str">    Args:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t64" class="pln"><span class="n"><a href="#t64">64</a></span><span class="t"><span class="str">        population (dict)          : A dictionary of a population with attributes.</span>&nbsp;</span><span class="r"></span></p>
    <p id="t65" class="pln"><span class="n"><a href="#t65">65</a></span><span class="t"><span class="str">        density_or_frequency (str) : option for the type of contact matrix calculated.</span>&nbsp;</span><span class="r"></span></p>
    <p id="t66" class="pln"><span class="n"><a href="#t66">66</a></span><span class="t"><span class="str">        setting_code (str)         : name of the physial contact setting: H for households, S for schools, W for workplaces, C for community or other, and 'lTCF' for long term care facilities</span>&nbsp;</span><span class="r"></span></p>
    <p id="t67" class="pln"><span class="n"><a href="#t67">67</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t68" class="pln"><span class="n"><a href="#t68">68</a></span><span class="t"><span class="str">    Returns:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t69" class="pln"><span class="n"><a href="#t69">69</a></span><span class="t"><span class="str">        Symmetric age specific contact matrix.</span>&nbsp;</span><span class="r"></span></p>
    <p id="t70" class="pln"><span class="n"><a href="#t70">70</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t71" class="pln"><span class="n"><a href="#t71">71</a></span><span class="t"><span class="str">    """</span>&nbsp;</span><span class="r"></span></p>
    <p id="t72" class="run"><span class="n"><a href="#t72">72</a></span><span class="t">    <span class="nam">uids</span> <span class="op">=</span> <span class="nam">population</span><span class="op">.</span><span class="nam">keys</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t73" class="run"><span class="n"><a href="#t73">73</a></span><span class="t">    <span class="nam">uids</span> <span class="op">=</span> <span class="op">[</span><span class="nam">uid</span> <span class="key">for</span> <span class="nam">uid</span> <span class="key">in</span> <span class="nam">uids</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t74" class="pln"><span class="n"><a href="#t74">74</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t75" class="run"><span class="n"><a href="#t75">75</a></span><span class="t">    <span class="nam">num_ages</span> <span class="op">=</span> <span class="num">101</span>&nbsp;</span><span class="r"></span></p>
    <p id="t76" class="pln"><span class="n"><a href="#t76">76</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t77" class="run"><span class="n"><a href="#t77">77</a></span><span class="t">    <span class="nam">M</span> <span class="op">=</span> <span class="nam">np</span><span class="op">.</span><span class="nam">zeros</span><span class="op">(</span><span class="op">(</span><span class="nam">num_ages</span><span class="op">,</span> <span class="nam">num_ages</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t78" class="pln"><span class="n"><a href="#t78">78</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t79" class="run"><span class="n"><a href="#t79">79</a></span><span class="t">    <span class="key">for</span> <span class="nam">n</span><span class="op">,</span> <span class="nam">uid</span> <span class="key">in</span> <span class="nam">enumerate</span><span class="op">(</span><span class="nam">uids</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t80" class="run"><span class="n"><a href="#t80">80</a></span><span class="t">        <span class="nam">age</span> <span class="op">=</span> <span class="nam">population</span><span class="op">[</span><span class="nam">uid</span><span class="op">]</span><span class="op">[</span><span class="str">'age'</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t81" class="run"><span class="n"><a href="#t81">81</a></span><span class="t">        <span class="nam">contact_ages</span> <span class="op">=</span> <span class="op">[</span><span class="nam">population</span><span class="op">[</span><span class="nam">c</span><span class="op">]</span><span class="op">[</span><span class="str">'age'</span><span class="op">]</span> <span class="key">for</span> <span class="nam">c</span> <span class="key">in</span> <span class="nam">population</span><span class="op">[</span><span class="nam">uid</span><span class="op">]</span><span class="op">[</span><span class="str">'contacts'</span><span class="op">]</span><span class="op">[</span><span class="nam">setting_code</span><span class="op">]</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t82" class="run"><span class="n"><a href="#t82">82</a></span><span class="t">        <span class="nam">contact_ages</span> <span class="op">=</span> <span class="nam">np</span><span class="op">.</span><span class="nam">array</span><span class="op">(</span><span class="op">[</span><span class="nam">int</span><span class="op">(</span><span class="nam">a</span><span class="op">)</span> <span class="key">for</span> <span class="nam">a</span> <span class="key">in</span> <span class="nam">contact_ages</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t83" class="pln"><span class="n"><a href="#t83">83</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t84" class="run"><span class="n"><a href="#t84">84</a></span><span class="t">        <span class="key">if</span> <span class="nam">len</span><span class="op">(</span><span class="nam">contact_ages</span><span class="op">)</span> <span class="op">></span> <span class="num">0</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t85" class="run"><span class="n"><a href="#t85">85</a></span><span class="t">            <span class="key">if</span> <span class="nam">density_or_frequency</span> <span class="op">==</span> <span class="str">'frequency'</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t86" class="mis show_mis"><span class="n"><a href="#t86">86</a></span><span class="t">                <span class="key">for</span> <span class="nam">ca</span> <span class="key">in</span> <span class="nam">contact_ages</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t87" class="mis show_mis"><span class="n"><a href="#t87">87</a></span><span class="t">                    <span class="nam">M</span><span class="op">[</span><span class="nam">age</span><span class="op">,</span> <span class="nam">ca</span><span class="op">]</span> <span class="op">+=</span> <span class="num">1.0</span> <span class="op">/</span> <span class="nam">len</span><span class="op">(</span><span class="nam">contact_ages</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t88" class="run"><span class="n"><a href="#t88">88</a></span><span class="t">            <span class="key">elif</span> <span class="nam">density_or_frequency</span> <span class="op">==</span> <span class="str">'density'</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t89" class="run"><span class="n"><a href="#t89">89</a></span><span class="t">                <span class="key">for</span> <span class="nam">ca</span> <span class="key">in</span> <span class="nam">contact_ages</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t90" class="run"><span class="n"><a href="#t90">90</a></span><span class="t">                    <span class="nam">M</span><span class="op">[</span><span class="nam">age</span><span class="op">,</span> <span class="nam">ca</span><span class="op">]</span> <span class="op">+=</span> <span class="num">1.0</span>&nbsp;</span><span class="r"></span></p>
    <p id="t91" class="run"><span class="n"><a href="#t91">91</a></span><span class="t">    <span class="key">return</span> <span class="nam">M</span>&nbsp;</span><span class="r"></span></p>
    <p id="t92" class="pln"><span class="n"><a href="#t92">92</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t93" class="pln"><span class="n"><a href="#t93">93</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t94" class="run"><span class="n"><a href="#t94">94</a></span><span class="t"><span class="key">def</span> <span class="nam">plot_contact_matrix</span><span class="op">(</span><span class="nam">matrix</span><span class="op">,</span> <span class="nam">age_count</span><span class="op">,</span> <span class="nam">aggregate_age_count</span><span class="op">,</span> <span class="nam">age_brackets</span><span class="op">,</span> <span class="nam">age_by_brackets_dic</span><span class="op">,</span> <span class="nam">setting_code</span><span class="op">=</span><span class="str">'H'</span><span class="op">,</span> <span class="nam">density_or_frequency</span><span class="op">=</span><span class="str">'density'</span><span class="op">,</span> <span class="nam">logcolors_flag</span><span class="op">=</span><span class="key">False</span><span class="op">,</span> <span class="nam">aggregate_flag</span><span class="op">=</span><span class="key">True</span><span class="op">,</span> <span class="nam">cmap</span><span class="op">=</span><span class="str">'cmr.freeze_r'</span><span class="op">,</span> <span class="nam">fontsize</span><span class="op">=</span><span class="num">16</span><span class="op">,</span> <span class="nam">rotation</span><span class="op">=</span><span class="num">50</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t95" class="pln"><span class="n"><a href="#t95">95</a></span><span class="t">    <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p id="t96" class="pln"><span class="n"><a href="#t96">96</a></span><span class="t"><span class="str">    Plots the age specific contact matrix where the matrix element matrix_ij is the contact rate or frequency</span>&nbsp;</span><span class="r"></span></p>
    <p id="t97" class="pln"><span class="n"><a href="#t97">97</a></span><span class="t"><span class="str">    for the average individual in age group i with all of their contacts in age group j. Can either be density</span>&nbsp;</span><span class="r"></span></p>
    <p id="t98" class="pln"><span class="n"><a href="#t98">98</a></span><span class="t"><span class="str">    or frequency definition, as well as a single year age contact matrix or a contact matrix for aggregated</span>&nbsp;</span><span class="r"></span></p>
    <p id="t99" class="pln"><span class="n"><a href="#t99">99</a></span><span class="t"><span class="str">    age brackets.</span>&nbsp;</span><span class="r"></span></p>
    <p id="t100" class="pln"><span class="n"><a href="#t100">100</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t101" class="pln"><span class="n"><a href="#t101">101</a></span><span class="t"><span class="str">    Args:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t102" class="pln"><span class="n"><a href="#t102">102</a></span><span class="t"><span class="str">        matrix (np.array)                : symmetric contact matrix, element ij is the contact for an average individual in age group i with all of their contacts in age group j</span>&nbsp;</span><span class="r"></span></p>
    <p id="t103" class="pln"><span class="n"><a href="#t103">103</a></span><span class="t"><span class="str">        age_count (dict)                 : dictionary with the count of individuals in the population for each age</span>&nbsp;</span><span class="r"></span></p>
    <p id="t104" class="pln"><span class="n"><a href="#t104">104</a></span><span class="t"><span class="str">        aggregate_age_count (dict)       : dictionary with the count of individuals in the population in each age bracket</span>&nbsp;</span><span class="r"></span></p>
    <p id="t105" class="pln"><span class="n"><a href="#t105">105</a></span><span class="t"><span class="str">        age_brackets (dict)              : dictionary mapping age bracket keys to age bracket range</span>&nbsp;</span><span class="r"></span></p>
    <p id="t106" class="pln"><span class="n"><a href="#t106">106</a></span><span class="t"><span class="str">        age_by_brackets_dic (dict)       : dictionary mapping age to the age bracket range it falls in</span>&nbsp;</span><span class="r"></span></p>
    <p id="t107" class="pln"><span class="n"><a href="#t107">107</a></span><span class="t"><span class="str">        setting_code (str)               : name of the physial contact setting: H for households, S for schools, W for workplaces, C for community or other</span>&nbsp;</span><span class="r"></span></p>
    <p id="t108" class="pln"><span class="n"><a href="#t108">108</a></span><span class="t"><span class="str">        density_or_frequency (str)       : If 'density', then each contact counts for 1/(group size -1) of a person's contact in a group, elif 'frequency' then count each contact. This means that more people in a group leads to higher rates of contact/exposure.</span>&nbsp;</span><span class="r"></span></p>
    <p id="t109" class="pln"><span class="n"><a href="#t109">109</a></span><span class="t"><span class="str">        logcolors_flag (bool)            : If True, plot heatmap in logscale</span>&nbsp;</span><span class="r"></span></p>
    <p id="t110" class="pln"><span class="n"><a href="#t110">110</a></span><span class="t"><span class="str">        aggregate_flag (book)            : If True, plot the contact matrix for aggregate age brackets, else single year age contact matrix.</span>&nbsp;</span><span class="r"></span></p>
    <p id="t111" class="pln"><span class="n"><a href="#t111">111</a></span><span class="t"><span class="str">        cmap(str or matplotlib colormap) : colormap</span>&nbsp;</span><span class="r"></span></p>
    <p id="t112" class="pln"><span class="n"><a href="#t112">112</a></span><span class="t"><span class="str">        fontsize (int)                   : base font size</span>&nbsp;</span><span class="r"></span></p>
    <p id="t113" class="pln"><span class="n"><a href="#t113">113</a></span><span class="t"><span class="str">        rotation (int)                   : rotation for x axis labels</span>&nbsp;</span><span class="r"></span></p>
    <p id="t114" class="pln"><span class="n"><a href="#t114">114</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t115" class="pln"><span class="n"><a href="#t115">115</a></span><span class="t"><span class="str">    Returns:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t116" class="pln"><span class="n"><a href="#t116">116</a></span><span class="t"><span class="str">        A fig object.</span>&nbsp;</span><span class="r"></span></p>
    <p id="t117" class="pln"><span class="n"><a href="#t117">117</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t118" class="pln"><span class="n"><a href="#t118">118</a></span><span class="t"><span class="str">    Note:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t119" class="pln"><span class="n"><a href="#t119">119</a></span><span class="t"><span class="str">        For the long term care facilities you may want the age count and the aggregate age count to only consider those who live or work in long term care facilities because otherwise this will be the whole population wide average mixing in that setting</span>&nbsp;</span><span class="r"></span></p>
    <p id="t120" class="pln"><span class="n"><a href="#t120">120</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t121" class="pln"><span class="n"><a href="#t121">121</a></span><span class="t"><span class="str">    """</span>&nbsp;</span><span class="r"></span></p>
    <p id="t122" class="run"><span class="n"><a href="#t122">122</a></span><span class="t">    <span class="nam">cmap</span> <span class="op">=</span> <span class="nam">mplt</span><span class="op">.</span><span class="nam">cm</span><span class="op">.</span><span class="nam">get_cmap</span><span class="op">(</span><span class="nam">cmap</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t123" class="pln"><span class="n"><a href="#t123">123</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t124" class="run"><span class="n"><a href="#t124">124</a></span><span class="t">    <span class="nam">fig</span> <span class="op">=</span> <span class="nam">plt</span><span class="op">.</span><span class="nam">figure</span><span class="op">(</span><span class="nam">figsize</span><span class="op">=</span><span class="op">(</span><span class="num">10</span><span class="op">,</span> <span class="num">10</span><span class="op">)</span><span class="op">,</span> <span class="nam">tight_layout</span><span class="op">=</span><span class="key">True</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t125" class="run"><span class="n"><a href="#t125">125</a></span><span class="t">    <span class="nam">ax</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t126" class="run"><span class="n"><a href="#t126">126</a></span><span class="t">    <span class="nam">cax</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t127" class="run"><span class="n"><a href="#t127">127</a></span><span class="t">    <span class="nam">cbar</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t128" class="run"><span class="n"><a href="#t128">128</a></span><span class="t">    <span class="nam">leg</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t129" class="run"><span class="n"><a href="#t129">129</a></span><span class="t">    <span class="nam">implot</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t130" class="pln"><span class="n"><a href="#t130">130</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t131" class="run"><span class="n"><a href="#t131">131</a></span><span class="t">    <span class="nam">titles</span> <span class="op">=</span> <span class="op">{</span><span class="str">'H'</span><span class="op">:</span> <span class="str">'Household'</span><span class="op">,</span> <span class="str">'S'</span><span class="op">:</span> <span class="str">'School'</span><span class="op">,</span> <span class="str">'W'</span><span class="op">:</span> <span class="str">'Work'</span><span class="op">,</span> <span class="str">'LTCF'</span><span class="op">:</span> <span class="str">'Long Term Care Facilities'</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t132" class="pln"><span class="n"><a href="#t132">132</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t133" class="run"><span class="n"><a href="#t133">133</a></span><span class="t">    <span class="key">if</span> <span class="nam">aggregate_flag</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t134" class="run"><span class="n"><a href="#t134">134</a></span><span class="t">        <span class="nam">aggregate_M</span> <span class="op">=</span> <span class="nam">spb</span><span class="op">.</span><span class="nam">get_aggregate_matrix</span><span class="op">(</span><span class="nam">matrix</span><span class="op">,</span> <span class="nam">age_by_brackets_dic</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t135" class="run"><span class="n"><a href="#t135">135</a></span><span class="t">        <span class="nam">asymmetric_M</span> <span class="op">=</span> <span class="nam">spb</span><span class="op">.</span><span class="nam">get_asymmetric_matrix</span><span class="op">(</span><span class="nam">aggregate_M</span><span class="op">,</span> <span class="nam">aggregate_age_count</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t136" class="pln"><span class="n"><a href="#t136">136</a></span><span class="t">    <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t137" class="mis show_mis"><span class="n"><a href="#t137">137</a></span><span class="t">        <span class="nam">asymmetric_M</span> <span class="op">=</span> <span class="nam">spb</span><span class="op">.</span><span class="nam">get_asymmetric_matrix</span><span class="op">(</span><span class="nam">matrix</span><span class="op">,</span> <span class="nam">age_count</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t138" class="pln"><span class="n"><a href="#t138">138</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t139" class="run"><span class="n"><a href="#t139">139</a></span><span class="t">    <span class="key">for</span> <span class="nam">i</span> <span class="key">in</span> <span class="nam">range</span><span class="op">(</span><span class="num">1</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t140" class="run"><span class="n"><a href="#t140">140</a></span><span class="t">        <span class="nam">ax</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">fig</span><span class="op">.</span><span class="nam">add_subplot</span><span class="op">(</span><span class="num">1</span><span class="op">,</span> <span class="num">1</span><span class="op">,</span> <span class="nam">i</span> <span class="op">+</span> <span class="num">1</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t141" class="pln"><span class="n"><a href="#t141">141</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t142" class="run"><span class="n"><a href="#t142">142</a></span><span class="t">    <span class="key">if</span> <span class="nam">logcolors_flag</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t143" class="pln"><span class="n"><a href="#t143">143</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t144" class="run"><span class="n"><a href="#t144">144</a></span><span class="t">        <span class="nam">vbounds</span> <span class="op">=</span> <span class="op">{</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t145" class="run"><span class="n"><a href="#t145">145</a></span><span class="t">        <span class="key">if</span> <span class="nam">density_or_frequency</span> <span class="op">==</span> <span class="str">'frequency'</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t146" class="mis show_mis"><span class="n"><a href="#t146">146</a></span><span class="t">            <span class="key">if</span> <span class="nam">aggregate_flag</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t147" class="mis show_mis"><span class="n"><a href="#t147">147</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'H'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-2</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e-0</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t148" class="mis show_mis"><span class="n"><a href="#t148">148</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'S'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-3</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e-0</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t149" class="mis show_mis"><span class="n"><a href="#t149">149</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'W'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-3</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e-0</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t150" class="mis show_mis"><span class="n"><a href="#t150">150</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'LTCF'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-3</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e-1</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t151" class="pln"><span class="n"><a href="#t151">151</a></span><span class="t">            <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t152" class="mis show_mis"><span class="n"><a href="#t152">152</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'H'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-3</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e-1</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t153" class="mis show_mis"><span class="n"><a href="#t153">153</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'S'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-3</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e-1</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t154" class="mis show_mis"><span class="n"><a href="#t154">154</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'W'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-3</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e-1</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t155" class="mis show_mis"><span class="n"><a href="#t155">155</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'LTCF'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-3</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e-0</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t156" class="pln"><span class="n"><a href="#t156">156</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t157" class="run"><span class="n"><a href="#t157">157</a></span><span class="t">        <span class="key">elif</span> <span class="nam">density_or_frequency</span> <span class="op">==</span> <span class="str">'density'</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t158" class="run"><span class="n"><a href="#t158">158</a></span><span class="t">            <span class="key">if</span> <span class="nam">aggregate_flag</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t159" class="run"><span class="n"><a href="#t159">159</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'H'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-2</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e0</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t160" class="run"><span class="n"><a href="#t160">160</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'S'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-2</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e1</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t161" class="run"><span class="n"><a href="#t161">161</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'W'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-2</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e1</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t162" class="run"><span class="n"><a href="#t162">162</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'LTCF'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-3</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e-0</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t163" class="pln"><span class="n"><a href="#t163">163</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t164" class="pln"><span class="n"><a href="#t164">164</a></span><span class="t">            <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t165" class="mis show_mis"><span class="n"><a href="#t165">165</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'H'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-2</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e0</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t166" class="mis show_mis"><span class="n"><a href="#t166">166</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'S'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-2</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e0</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t167" class="mis show_mis"><span class="n"><a href="#t167">167</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'W'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-2</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e0</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t168" class="mis show_mis"><span class="n"><a href="#t168">168</a></span><span class="t">                <span class="nam">vbounds</span><span class="op">[</span><span class="str">'LTCF'</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="str">'vmin'</span><span class="op">:</span> <span class="num">1e-2</span><span class="op">,</span> <span class="str">'vmax'</span><span class="op">:</span> <span class="num">1e-0</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p id="t169" class="pln"><span class="n"><a href="#t169">169</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t170" class="run"><span class="n"><a href="#t170">170</a></span><span class="t">        <span class="nam">im</span> <span class="op">=</span> <span class="nam">ax</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">.</span><span class="nam">imshow</span><span class="op">(</span><span class="nam">asymmetric_M</span><span class="op">.</span><span class="nam">T</span><span class="op">,</span> <span class="nam">origin</span><span class="op">=</span><span class="str">'lower'</span><span class="op">,</span> <span class="nam">interpolation</span><span class="op">=</span><span class="str">'nearest'</span><span class="op">,</span> <span class="nam">cmap</span><span class="op">=</span><span class="nam">cmap</span><span class="op">,</span> <span class="nam">norm</span><span class="op">=</span><span class="nam">LogNorm</span><span class="op">(</span><span class="nam">vmin</span><span class="op">=</span><span class="nam">vbounds</span><span class="op">[</span><span class="nam">setting_code</span><span class="op">]</span><span class="op">[</span><span class="str">'vmin'</span><span class="op">]</span><span class="op">,</span> <span class="nam">vmax</span><span class="op">=</span><span class="nam">vbounds</span><span class="op">[</span><span class="nam">setting_code</span><span class="op">]</span><span class="op">[</span><span class="str">'vmax'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t171" class="pln"><span class="n"><a href="#t171">171</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t172" class="pln"><span class="n"><a href="#t172">172</a></span><span class="t">    <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t173" class="pln"><span class="n"><a href="#t173">173</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t174" class="mis show_mis"><span class="n"><a href="#t174">174</a></span><span class="t">        <span class="nam">im</span> <span class="op">=</span> <span class="nam">ax</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">.</span><span class="nam">imshow</span><span class="op">(</span><span class="nam">asymmetric_M</span><span class="op">.</span><span class="nam">T</span><span class="op">,</span> <span class="nam">origin</span><span class="op">=</span><span class="str">'lower'</span><span class="op">,</span> <span class="nam">interpolation</span><span class="op">=</span><span class="str">'nearest'</span><span class="op">,</span> <span class="nam">cmap</span><span class="op">=</span><span class="nam">cmap</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t175" class="pln"><span class="n"><a href="#t175">175</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t176" class="run"><span class="n"><a href="#t176">176</a></span><span class="t">    <span class="nam">implot</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">im</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t177" class="pln"><span class="n"><a href="#t177">177</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t178" class="run"><span class="n"><a href="#t178">178</a></span><span class="t">    <span class="key">if</span> <span class="nam">fontsize</span> <span class="op">></span> <span class="num">20</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t179" class="mis show_mis"><span class="n"><a href="#t179">179</a></span><span class="t">        <span class="nam">rotation</span> <span class="op">=</span> <span class="num">90</span>&nbsp;</span><span class="r"></span></p>
    <p id="t180" class="pln"><span class="n"><a href="#t180">180</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t181" class="run"><span class="n"><a href="#t181">181</a></span><span class="t">    <span class="key">for</span> <span class="nam">i</span> <span class="key">in</span> <span class="nam">range</span><span class="op">(</span><span class="nam">len</span><span class="op">(</span><span class="nam">ax</span><span class="op">)</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t182" class="run"><span class="n"><a href="#t182">182</a></span><span class="t">        <span class="nam">divider</span> <span class="op">=</span> <span class="nam">make_axes_locatable</span><span class="op">(</span><span class="nam">ax</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t183" class="run"><span class="n"><a href="#t183">183</a></span><span class="t">        <span class="nam">cax</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">divider</span><span class="op">.</span><span class="nam">new_horizontal</span><span class="op">(</span><span class="nam">size</span><span class="op">=</span><span class="str">"4%"</span><span class="op">,</span> <span class="nam">pad</span><span class="op">=</span><span class="num">0.15</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t184" class="pln"><span class="n"><a href="#t184">184</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t185" class="run"><span class="n"><a href="#t185">185</a></span><span class="t">        <span class="nam">fig</span><span class="op">.</span><span class="nam">add_axes</span><span class="op">(</span><span class="nam">cax</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t186" class="run"><span class="n"><a href="#t186">186</a></span><span class="t">        <span class="nam">cbar</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">fig</span><span class="op">.</span><span class="nam">colorbar</span><span class="op">(</span><span class="nam">implot</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">,</span> <span class="nam">cax</span><span class="op">=</span><span class="nam">cax</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t187" class="run"><span class="n"><a href="#t187">187</a></span><span class="t">        <span class="nam">cbar</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">.</span><span class="nam">ax</span><span class="op">.</span><span class="nam">tick_params</span><span class="op">(</span><span class="nam">axis</span><span class="op">=</span><span class="str">'y'</span><span class="op">,</span> <span class="nam">labelsize</span><span class="op">=</span><span class="nam">fontsize</span> <span class="op">+</span> <span class="num">4</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t188" class="run"><span class="n"><a href="#t188">188</a></span><span class="t">        <span class="key">if</span> <span class="nam">density_or_frequency</span> <span class="op">==</span> <span class="str">'frequency'</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t189" class="mis show_mis"><span class="n"><a href="#t189">189</a></span><span class="t">            <span class="nam">cbar</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">.</span><span class="nam">ax</span><span class="op">.</span><span class="nam">set_ylabel</span><span class="op">(</span><span class="str">'Frequency of Contacts'</span><span class="op">,</span> <span class="nam">fontsize</span><span class="op">=</span><span class="nam">fontsize</span> <span class="op">+</span> <span class="num">2</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t190" class="pln"><span class="n"><a href="#t190">190</a></span><span class="t">        <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t191" class="run"><span class="n"><a href="#t191">191</a></span><span class="t">            <span class="nam">cbar</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">.</span><span class="nam">ax</span><span class="op">.</span><span class="nam">set_ylabel</span><span class="op">(</span><span class="str">'Density of Contacts'</span><span class="op">,</span> <span class="nam">fontsize</span><span class="op">=</span><span class="nam">fontsize</span> <span class="op">+</span> <span class="num">2</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t192" class="run"><span class="n"><a href="#t192">192</a></span><span class="t">        <span class="nam">ax</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">.</span><span class="nam">tick_params</span><span class="op">(</span><span class="nam">labelsize</span><span class="op">=</span><span class="nam">fontsize</span> <span class="op">+</span> <span class="num">2</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t193" class="run"><span class="n"><a href="#t193">193</a></span><span class="t">        <span class="nam">ax</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">.</span><span class="nam">set_xlabel</span><span class="op">(</span><span class="str">'Age'</span><span class="op">,</span> <span class="nam">fontsize</span><span class="op">=</span><span class="nam">fontsize</span> <span class="op">+</span> <span class="num">6</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t194" class="run"><span class="n"><a href="#t194">194</a></span><span class="t">        <span class="nam">ax</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">.</span><span class="nam">set_ylabel</span><span class="op">(</span><span class="str">'Age of Contacts'</span><span class="op">,</span> <span class="nam">fontsize</span><span class="op">=</span><span class="nam">fontsize</span> <span class="op">+</span> <span class="num">6</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t195" class="pln"><span class="n"><a href="#t195">195</a></span><span class="t">        <span class="com"># ax[i].set_title(titles[setting_code] + ' Contact Patterns', fontsize=fontsize + 10)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t196" class="run"><span class="n"><a href="#t196">196</a></span><span class="t">        <span class="nam">ax</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">.</span><span class="nam">set_title</span><span class="op">(</span><span class="nam">titles</span><span class="op">[</span><span class="nam">setting_code</span><span class="op">]</span> <span class="op">+</span> <span class="str">' Age Mixing'</span><span class="op">,</span> <span class="nam">fontsize</span><span class="op">=</span><span class="nam">fontsize</span> <span class="op">+</span> <span class="num">10</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t197" class="pln"><span class="n"><a href="#t197">197</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t198" class="run"><span class="n"><a href="#t198">198</a></span><span class="t">        <span class="key">if</span> <span class="nam">aggregate_flag</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t199" class="run"><span class="n"><a href="#t199">199</a></span><span class="t">            <span class="nam">tick_labels</span> <span class="op">=</span> <span class="op">[</span><span class="nam">str</span><span class="op">(</span><span class="nam">age_brackets</span><span class="op">[</span><span class="nam">b</span><span class="op">]</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="str">'-'</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="nam">age_brackets</span><span class="op">[</span><span class="nam">b</span><span class="op">]</span><span class="op">[</span><span class="op">-</span><span class="num">1</span><span class="op">]</span><span class="op">)</span> <span class="key">for</span> <span class="nam">b</span> <span class="key">in</span> <span class="nam">age_brackets</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t200" class="run"><span class="n"><a href="#t200">200</a></span><span class="t">            <span class="nam">ax</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">.</span><span class="nam">set_xticks</span><span class="op">(</span><span class="nam">np</span><span class="op">.</span><span class="nam">arange</span><span class="op">(</span><span class="nam">len</span><span class="op">(</span><span class="nam">tick_labels</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t201" class="run"><span class="n"><a href="#t201">201</a></span><span class="t">            <span class="nam">ax</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">.</span><span class="nam">set_xticklabels</span><span class="op">(</span><span class="nam">tick_labels</span><span class="op">,</span> <span class="nam">fontsize</span><span class="op">=</span><span class="nam">fontsize</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t202" class="run"><span class="n"><a href="#t202">202</a></span><span class="t">            <span class="nam">ax</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">.</span><span class="nam">set_xticklabels</span><span class="op">(</span><span class="nam">tick_labels</span><span class="op">,</span> <span class="nam">fontsize</span><span class="op">=</span><span class="nam">fontsize</span><span class="op">,</span> <span class="nam">rotation</span><span class="op">=</span><span class="nam">rotation</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t203" class="run"><span class="n"><a href="#t203">203</a></span><span class="t">            <span class="nam">ax</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">.</span><span class="nam">set_yticks</span><span class="op">(</span><span class="nam">np</span><span class="op">.</span><span class="nam">arange</span><span class="op">(</span><span class="nam">len</span><span class="op">(</span><span class="nam">tick_labels</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t204" class="run"><span class="n"><a href="#t204">204</a></span><span class="t">            <span class="nam">ax</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">.</span><span class="nam">set_yticklabels</span><span class="op">(</span><span class="nam">tick_labels</span><span class="op">,</span> <span class="nam">fontsize</span><span class="op">=</span><span class="nam">fontsize</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t205" class="pln"><span class="n"><a href="#t205">205</a></span><span class="t">        <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t206" class="mis show_mis"><span class="n"><a href="#t206">206</a></span><span class="t">            <span class="nam">ax</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">.</span><span class="nam">set_xticks</span><span class="op">(</span><span class="nam">np</span><span class="op">.</span><span class="nam">arange</span><span class="op">(</span><span class="num">0</span><span class="op">,</span> <span class="nam">len</span><span class="op">(</span><span class="nam">age_count</span><span class="op">)</span> <span class="op">+</span> <span class="num">1</span><span class="op">,</span> <span class="num">10</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t207" class="mis show_mis"><span class="n"><a href="#t207">207</a></span><span class="t">            <span class="nam">ax</span><span class="op">[</span><span class="nam">i</span><span class="op">]</span><span class="op">.</span><span class="nam">set_yticks</span><span class="op">(</span><span class="nam">np</span><span class="op">.</span><span class="nam">arange</span><span class="op">(</span><span class="num">0</span><span class="op">,</span> <span class="nam">len</span><span class="op">(</span><span class="nam">age_count</span><span class="op">)</span> <span class="op">+</span> <span class="num">1</span><span class="op">,</span> <span class="num">10</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t208" class="pln"><span class="n"><a href="#t208">208</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t209" class="run"><span class="n"><a href="#t209">209</a></span><span class="t">    <span class="key">return</span> <span class="nam">fig</span>&nbsp;</span><span class="r"></span></p>
    <p id="t210" class="pln"><span class="n"><a href="#t210">210</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t211" class="pln"><span class="n"><a href="#t211">211</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
</div>
<div id="footer">
    <div class="content">
        <p>
            <a class="nav" href="index.html">&#xab; index</a> &nbsp; &nbsp; <a class="nav" href="https://coverage.readthedocs.io">coverage.py v5.2</a>,
            created at 2020-07-15 10:13
        </p>
    </div>
</div>
</body>
</html>
